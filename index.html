<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hello Bulma!</title>
    <link rel="stylesheet" href="./bulma.css">
    <link rel="stylesheet" href="./swatch.min.css">
    <link rel="stylesheet" href="./main.css">

    <script src="./jquery.js"></script>
</head>

<body>
    <a role="button" id="burger" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <aside class="menu navbar-menu" data-active="false" id="menu">
        <ul class="menu-list" id="batteryManagementLink">
            <li><a>Battery Management</a></li>
        </ul>
        <ul class="menu-list" id="safteyLink">
            <li><a>Saftey Info</a></li>
        </ul>
        <ul class="menu-list" id="creditsLink">
            <li><a>Credits</a></li>
        </ul>
        <ul class="menu-list" id="calcLink">
            <li><a>Calculator</a></li>
        </ul>
    </aside>
    <section id="calc" class="section">
        <div class="columns is-flex is-vcentered is-centered">
            <div class="box column is-two-thirds is-half-tablet">
                <div class="select is-primary">
                    <select id="chem" data-chem="lipo" data-cellVoltage="4.2">
                        <option>LiPo</option>
                        <option>LiHv</option>
                    </select>
                </div>
                <input id="cells" class="input" type="number" placeholder="How many cells (S value)">
                <input id="mah" class="input" type="number" placeholder="Battery cap (in mAh)">
                <div>
                    <label>Min voltage:</label>
                    <span id="minVolt">

                    </span>
                </div>
                <div>
                    <label>Max voltage:</label>
                    <span id="maxVolt">

                    </span>
                </div>
                <div>
                    <label>Storage voltage:</label>
                    <span id="storVolt">

                    </span>
                </div>
                <div>
                    <label>Charge Rate (in A):</label>
                    <span id="chargeRate">

                    </span>
                </div>
            </div>
        </div>
    </section>
    <section id="batteryManagement" class="section"></section>
    <section id="credits" class="section">
        <p class="columns is-flex is-vcentered is-centered">Hate ads? So do we, keep our app free by donating a cup of
            coffee to the devs.</p>
        <div class="tile is-ancestor columns is-flex is-vcentered is-centered">
            <div class="tile is-vertical is-8">
                <div class="tile">
                    <div class="tile is-parent">
                        <article class="tile is-child notification is-info">
                            <p class="title">Michael LaPan</p>
                            <p class="subtitle">UI/UX/Calculator</p>
                            <a href="https://www.buymeacoffee.com/michaellapan">
                                <figure class="image is-4by2">
                                    <img href="https://www.buymeacoffee.com/michaellapan"
                                        src="https://img.buymeacoffee.com/api/?url=aHR0cHM6Ly9pbWcuYnV5bWVhY29mZmVlLmNvbS9hcGkvP25hbWU9bWljaGFlbGxhcGFuJnNpemU9MzAwJmJnLWltYWdlPWJtYyZiYWNrZ3JvdW5kPQ==&creator=michaellapan&design_code=1&design_color=%23BD5FFF&slug=michaellapan">
                                </figure>
                            </a>
                        </article>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section id="saftey" class="section">

    </section>
    <script>
        $(document).ready(function () {
            hideAllShowOne("calc");
            $("#burger").click(function () {
                $("#menu").data("active", !$("#menu").data('active'));
                $("#menu").toggleClass('is-active');
            });

            $("#chem").on('change', function (e) {
                $("#chem").data("chem", e.target.value)
                if (e.target.value == "LiPo") {
                    $("#chem").data("cellvoltage", 4.2)
                } else {
                    $("#chem").data("cellvoltage", 4.35)
                }
                populateBattInfo();
            })

            $("#cells").on('input', function (e) {
                populateBattInfo();
            });

            $("#mah").on('input', function (e) {
                populateBattInfo();
            });

            function populateBattInfo() {
                let cells = parseFloat($("#cells").val());
                if (!isNaN(cells)) {
                    $("#chargeRate").text(toTwo(parseFloat($("#mah").val()) / 1000))
                    $("#minVolt").text(toTwo(3.5 * parseFloat($("#cells").val())))
                    $("#maxVolt").text(toTwo(parseFloat($("#chem").data("cellvoltage")) * parseFloat($("#cells").val())))
                    $("#storVolt").text(toTwo(parseFloat($("#cells").val()) * 3.80))
                }
            }

            function toTwo(num) {
                return Math.round((num + Number.EPSILON) * 100) / 100
            }

            function hideAllShowOne(idOfOneToShow) {
                $("#calc").hide();
                $("#batteryManagement").hide();
                $("#credits").hide();
                $("#saftey").hide();
                $("#" + idOfOneToShow).show();
            }

            $("ul").click(function () {
                hideAllShowOne($(this).attr("id").replace("Link", ""));
            })

        });
    </script>
</body>

</html>